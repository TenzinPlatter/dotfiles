#!/usr/bin/env python3

import os
import sys

import argparse


def build_command(container: str, follow: bool) -> str:
    return " ".join(["docker logs", "-f" if follow else "", f"{container}"])


def main():
    parser = argparse.ArgumentParser(description="Docker logs helper")

    parser.add_argument("-l", "--lookout", help="Use a lookout container", action="store_true")
    parser.add_argument("-g", "--gama", help="Use a gama container", action="store_true")
    parser.add_argument("-m", "--missim", help="Use a missim container", action="store_true")
    parser.add_argument("-n", "--no-follow", help="Don't tail the logs", action="store_true")
    parser.add_argument("container", help="Container name")

    args = parser.parse_args()
    container_name = ""
    if args.lookout:
        container_name = "lookout_"

    if args.gama:
        container_name = "gama_"

    if args.missim:
        container_name = "missim_"

    container_name += args.container

    exec_cmd = build_command(container_name, not args.no_follow)
    exit_code = os.system(exec_cmd)
    sys.exit(exit_code >> 8)  # Convert to normal exit code  # noqa: F821


if __name__ == "__main__":
    main()
